---
layout: single
title:  "Chapter14. Classifying Images with Deep Convolutional Neural Networkss"
use_math: true
---

#### Topic
* 이 장에서는 이미지 분류를 위한 **컨벌루션 신경망(convolutional neural networks, CNNs)** 에 대한 내용임.
* 상향식 접근법(bottom-up-approach)을 사용하여 CNN의 기본 구성 요소에 대해 논의하는 것을 시작으로 CNN의 아키텍처에 대해 더 자세히 알아보고 파이토치에서 CNN을 구현하는 방법에 대해 알아봄. 
* 다음과 같은 항목을 다룸.
* 1) 1차원 및 2차원에서의 컨벌루션 연산
* 2) CNN 아키텍처의 구성 요소
* 3) 파이토치에서 심층 CNN 구현 
* 4) 일반화 성능 향상을 위한 데이터 확대 기법(data augmentation techiques)
* 5) 웃고있는 여부를 인식하기 위한 CNN 얼굴 분류기 구현 

## 1. Understanding CNNs and feature hierarchies: CNN 및 기능 계층 이해

* **중요한(관련) 특징(salient (relevant) features)** 을 성공적으로 추출하는 것은 모든 머신 러닝 알고리즘의 핵심 성능임. 전통적인 머신러닝 모델은 도메인 전문가가 제공하거나 계산 특징 추출 기술은 기반으로하는 입력 특징에 의존함. 이러한 이유로 CNN 레이어를 **특성 추출기**로 간주하는 것이 일반적임.
* 초기 레이어(입력 레이어 바로 뒤의 레이어)는 원시 데이터에서 낮은 수준의 특성을 추출하고, 후기 레이어(MLP처럼 완전 연결된 레이어)는 이러한 특성을 사용하여 연속적인 목표 값 또는 클래스 레이블을 예측함.
* 특성 유형의 다층 NN, 특히 심층 CNN은 **낮은 수준의 기능을 계층별 방식으로 결합하여 높은 수준의 특성을 형성함으로써 소위 특성 계층(feature hierarchy)을 구성함.** 
* 예를 들어, 이미지를 다루는 경우에 가장자리와 블롭과 같은 낮은 수준의 특성가 이전 레이어에서 추출되고, 이는 결합되어 높은 수준의 특성을 형성함. 
* 이와 같은 높은 수준의 특성은 건물이나 동물 같은 물체의 윤곽과 같은 복잡한 모양을 형성할 수 있음.


<figcaption style="text-align:center; font-size:15px; color:#808080">
Fig.1. Creating feature maps from an image (photo by Alexander Dummer on Unsplash)
</figcaption>

* 위 그림처럼 CNN은 입력 이미지에서 특성 맵을 계산함. 여기서 각 요소는 입력 이미지 픽셀의 로컬 패치에서 나옴.
* 이러한 픽셀들의 로컬 패치를 로컬 수용 필드(local receptive field)라함. CNN은 일반적으로 이미지 관련 작업에서 잘 수행되며 이는 다음과 같은 두 가지 아이디어 때문임.
* **희소 연결(sparse connectivity)**: 특성 맵의 단일 요소는 작은 픽셀 패치에만 연결된다(MLP의 경우와 같이 전체 입력 이미지에 연결하는 것과는 매우 다르다).
* **매개 변수 공유(parameter sharing)**: 입력 이미지의 다른 패치에 동일한 가중치가 사용됨.
* 위 두 아이디어의 결과로, 완전히 연결된 기존의 MLP를 컨볼루션 레이어로 대체하면 네트워크의 가중치(파라미터) 수가 상당히 감소하며, 두드러진 특성을 포착하는 능력이 향상됨.
* 이미지 데이터의 맥락에서, 가까운 거리의 픽셀들은 일반적으로 서로 멀리 떨어져 있는 픽셀들보다 서로에게 더 관련이 있다고 가정하는 것이 타당함.
* 일반적으로 **CNN은 끝에 하나 이상의 완전히 연결된 계층이 이어지는 여러 컨볼루션 및 하위 샘플링 계층으로 구성**됨. 완전히 연결된 층은 기본적으로 MLP이며, 여기서 모든 입력 단위 i는 가중치 $w_{ij}$로 모든 출력 단위 j에 연결됨.
* 일반적으로 **풀링 레이어(pooling layers)** 로 알려진 하위 샘플링 레이어에는 학습 가능한 매개 변수가 없음. 예를 들어 풀링 레이어에는 가중치 또는 편향 단위가 없지만 컨볼루션 레이어와 완전히 연결된 레이어 모두 훈련 중에 최적화된 가중치와 편향이 존재함.

## 2. Understanding CNNs and feature hierarchies: 이산 컨볼루션 수행

* 이산 컨볼루션(discrete convolution (or simply convolution))은 CNN의 기본 연산으로 어떻게 작동하는지 이해하는 것이 중요함. 

#### Discrete convolutions in one dimension: 1차원에서의 이산 컨볼루션

